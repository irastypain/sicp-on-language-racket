# [Глава 1. Построение абстракций с помощью процедур](index.md#Глава-1-Построение-абстракций-с-помощью-процедур)
## [1.3. Формулирование абстракций с помощью процедур высших порядков](index.md#13-Формулирование-абстракций-с-помощью-процедур-высших-порядков)

### Упражнение 1.33
Можно получить еще более общую версию `accumulate` (упражнение 1.32), если
ввести понятие _фильтра_ (filter) на комбинируемые термы. То есть комбинировать
только те термы, порождённые из значений диапазона, которые удовлетворяют
указанному условию. Получающаяся абстракция `filtered-accumulate` получает те же
аргументы, что и `accumulate`, плюс дополнительный одноаргументный предикат,
который определяет фильтр. Запишите `filtered-accumulate` в виде процедуры.
Покажите, как с помощью `filtered-accumulate` выразить следующее:

а. сумму квадратов простых чисел в интервале от _a_ до _b_ (в предположении,
что процедура `prime?` уже написана);

б. произведение всех положительных целых чисел меньше _n_, которые просты по
отношению к _n_ (то есть всех таких положительных целых чисел _i_ < _n_, что
НОД(_i_, _n_) = 1).

#### Решение
[Код](../../src/chapter01/exercise_1_33.rkt) | [Тест](../../test/chapter01/test_exercise_1_33.rkt)
--- | ---
